<div class="register-wrapper">
    <header>
        <div class="logo">
            <img src="/assets/moveo.png" alt="Moveo Logo" />
            <span>MOVEO</span>
        </div>
        <button class="signup-button">Sign Up</button>
    </header>

    <main class="register-box">
        <div class="form-section">
            <h1>Complete Your Profile</h1>
            <p>Just a few more details to get started</p>

            <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
                <div class="form-grid">
                    <mat-form-field appearance="outline">
                        <mat-label>Full Name</mat-label>
                        <input matInput formControlName="fullName" placeholder="Enter your full name" />
                        <mat-icon matSuffix>person</mat-icon>
                        <mat-error *ngIf="registerForm.get('fullName')?.hasError('required')">
                            Name is required
                        </mat-error>
                        <mat-error *ngIf="registerForm.get('fullName')?.hasError('minlength')">
                            Name must be at least 2 characters
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>DNI / ID Number</mat-label>
                        <input matInput formControlName="dni" placeholder="Enter your DNI" />
                        <mat-icon matSuffix>badge</mat-icon>
                        <mat-error *ngIf="registerForm.get('dni')?.hasError('required')">
                            DNI is required
                        </mat-error>
                        <mat-error *ngIf="registerForm.get('dni')?.hasError('pattern')">
                            Please enter a valid DNI (8 digits)
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Phone Number</mat-label>
                        <input matInput formControlName="phone" placeholder="Enter your phone number" />
                        <mat-icon matSuffix>phone</mat-icon>
                        <mat-error *ngIf="registerForm.get('phone')?.hasError('required')">
                            Phone number is required
                        </mat-error>
                        <mat-error *ngIf="registerForm.get('phone')?.hasError('pattern')">
                            Please enter a valid phone number
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Email</mat-label>
                        <input matInput type="email" formControlName="email" placeholder="Enter your email" />
                        <mat-icon matSuffix>email</mat-icon>
                        <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
                            Email is required
                        </mat-error>
                        <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
                            Please enter a valid email
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Password</mat-label>
                        <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" placeholder="Create a password" />
                        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
                            <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                        <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
                            Password is required
                        </mat-error>
                        <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">
                            Password must be at least 6 characters
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Confirm Password</mat-label>
                        <input matInput [type]="hideRepeatPassword ? 'password' : 'text'" formControlName="repeatPassword" placeholder="Confirm your password" />
                        <button mat-icon-button matSuffix (click)="hideRepeatPassword = !hideRepeatPassword" type="button">
                            <mat-icon>{{hideRepeatPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                        <mat-error *ngIf="registerForm.hasError('mismatch') && registerForm.get('repeatPassword')?.touched">
                            Passwords must match
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="photo-upload-section">
                    <h3>Profile Photo (Optional)</h3>
                    <div class="photo-upload" (click)="fileInput.click()">
                        <div class="photo-preview" *ngIf="selectedFile; else noPhoto">
                            <img [src]="photoPreview" alt="Profile preview" />
                        </div>
                        <ng-template #noPhoto>
                            <div class="photo-placeholder">
                                <mat-icon>add_a_photo</mat-icon>
                                <span>Add Profile Photo</span>
                            </div>
                        </ng-template>
                    </div>
                    <input #fileInput type="file" (change)="onFileSelected($event)" accept="image/*" hidden />
                </div>

                <div class="terms-section">
                    <mat-checkbox formControlName="acceptTerms" [disabled]="!hasReadTerms">
                        I accept the <a href="#" (click)="openTermsDialog($event)">Terms and Conditions</a>
                    </mat-checkbox>
                    <mat-error *ngIf="registerForm.get('acceptTerms')?.hasError('required') && registerForm.get('acceptTerms')?.touched">
                        You must accept the terms and conditions
                    </mat-error>
                </div>

                <button mat-raised-button color="primary" type="submit"
                        [disabled]="registerForm.invalid || isLoading"
                        class="submit-button">
                    <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
                    <span *ngIf="!isLoading">Create Account</span>
                </button>
            </form>

            <div class="signin-link">
                <a routerLink="/login">Already a member? Sign In</a>
            </div>
        </div>

        <div class="image-section">
            <img src="/assets/car.png" alt="Car Illustration" />
        </div>
    </main>
</div>
